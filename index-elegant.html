<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Elegant Site Builder</title>

  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://js.puter.com/v2/"></script>

  <style>
    .serif { font-family: 'Playfair Display', serif; }
    .sans { font-family: 'Inter', sans-serif; }
    .elegant-shadow { box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(255, 255, 255, 0.05); }
    .elegant-border { border: 1px solid rgba(229, 231, 235, 0.2); }
    .elegant-hover { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    .elegant-hover:hover { transform: translateY(-2px); box-shadow: 0 32px 64px -12px rgba(0, 0, 0, 0.35); }
  </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-slate-50 via-white to-gray-100 sans">
  
  <div class="min-h-screen p-8">
    <div class="max-w-7xl mx-auto">
      
      <!-- Header -->
      <header class="mb-12">
        <div class="bg-white/80 backdrop-blur-sm elegant-border rounded-2xl p-8 elegant-shadow">
          <div class="flex items-center justify-between">
            <h1 class="text-5xl serif font-medium text-gray-900">✨ Elegant Builder</h1>
            <div class="flex gap-4">
              <button id="version-toggle" 
                class="px-6 py-3 bg-gray-900 text-white rounded-xl font-medium 
                       elegant-hover">
                Back to Original
              </button>
              <button id="toggle-chat" class="md:hidden px-4 py-3 text-gray-600 hover:text-gray-900 transition">
                Chat
              </button>
            </div>
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <main class="grid grid-cols-1 lg:grid-cols-5 gap-8 mb-12">
        
        <!-- Editor -->
        <div class="lg:col-span-3">
          <div class="bg-white/80 backdrop-blur-sm elegant-border rounded-2xl p-8 elegant-shadow">
            <div class="flex items-center justify-between mb-6">
              <h2 class="text-2xl serif font-medium text-gray-900">Code Editor</h2>
              <div class="flex gap-2">
                <div class="w-3 h-3 bg-red-400 rounded-full"></div>
                <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
                <div class="w-3 h-3 bg-green-400 rounded-full"></div>
              </div>
            </div>
            <textarea id="editor"
              class="w-full h-96 p-6 bg-gray-50/50 border border-gray-200/50 rounded-xl
                     font-mono text-sm text-gray-800 resize-none focus:outline-none
                     focus:ring-2 focus:ring-gray-300 focus:border-transparent
                     transition-all" spellcheck="false"
              placeholder="Write your elegant code here..."><!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Elegant Design</title>
    <style>
      body { 
        font-family: 'Playfair Display', serif; 
        margin: 0; 
        padding: 3rem; 
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        color: #2d3748;
      }
      .container { 
        max-width: 800px; 
        margin: 0 auto; 
        text-align: center; 
        background: white;
        padding: 4rem;
        border-radius: 1rem;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      }
      h1 { 
        font-size: 3rem; 
        font-weight: 500; 
        margin-bottom: 2rem; 
        color: #1a202c;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Elegant Simplicity</h1>
      <p>Where form meets function in perfect harmony.</p>
    </div>
  </body>
</html></textarea>
          </div>
        </div>

        <!-- Chat Panel -->
        <aside id="chat-aside" class="hidden lg:block lg:col-span-2">
          <div class="bg-white/80 backdrop-blur-sm elegant-border rounded-2xl elegant-shadow h-full flex flex-col">
            <div class="p-6 border-b border-gray-200/50">
              <h3 class="text-xl serif font-medium text-gray-900">AI Assistant</h3>
            </div>
            <div id="messages" class="flex-1 p-6 space-y-4 overflow-y-auto text-sm min-h-0">
              <div class="text-gray-500 text-center py-12 serif">
                How may I assist you today?
              </div>
            </div>
            <div class="p-6 border-t border-gray-200/50">
              <div class="flex gap-3">
                <textarea id="chat-textarea"
                  class="flex-1 p-4 bg-gray-50/50 border border-gray-200/50 rounded-xl
                         text-gray-800 resize-none focus:outline-none focus:ring-2
                         focus:ring-gray-300 focus:border-transparent placeholder-gray-500
                         transition-all"
                  placeholder="Ask me anything..." rows="1"></textarea>
                <button id="chat-send"
                  class="px-6 py-4 bg-gray-900 text-white rounded-xl font-medium
                         hover:bg-gray-800 transition-colors">
                  Send
                </button>
              </div>
            </div>
          </div>
        </aside>
      </main>

      <!-- Controls -->
      <section class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
        <div class="bg-white/80 backdrop-blur-sm elegant-border rounded-2xl p-8 elegant-shadow">
          <h3 class="text-xl serif font-medium text-gray-900 mb-6">Deployment Settings</h3>
          <label class="block mb-4">
            <span class="text-gray-700 font-medium mb-3 block">Subdomain</span>
            <input id="sub"
              class="w-full px-4 py-4 bg-gray-50/50 border border-gray-200/50 rounded-xl
                     text-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-300
                     focus:border-transparent placeholder-gray-500 transition-all"
              placeholder="Leave blank for random name">
          </label>
          <p class="text-sm text-gray-600">
            Use letters, numbers, and hyphens only. Cannot start or end with hyphen.
          </p>
        </div>

        <div class="bg-white/80 backdrop-blur-sm elegant-border rounded-2xl p-8 elegant-shadow">
          <h3 class="text-xl serif font-medium text-gray-900 mb-6">Actions</h3>
          <div class="flex gap-4 mb-6">
            <button id="publish"
              class="flex-1 flex items-center justify-center gap-3 px-6 py-4
                     bg-gray-900 text-white rounded-xl font-medium
                     elegant-hover">
              <span>Publish</span>
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
              </svg>
            </button>
            <button id="clear-log"
              class="px-6 py-4 bg-gray-100 text-gray-700 rounded-xl font-medium
                     hover:bg-gray-200 transition-colors">
              Clear
            </button>
          </div>
          <pre id="log" class="text-sm text-gray-600 bg-gray-50/50 rounded-xl p-4 h-24 overflow-y-auto border border-gray-200/50">Ready to publish your elegant site...</pre>
        </div>
      </section>
    </div>
  </div>

  <script>
    const $ = s => document.querySelector(s);
    const log = t => {
      const logEl = $('#log');
      logEl.textContent += new Date().toLocaleTimeString() + ' - ' + t + '\n';
      logEl.scrollTop = logEl.scrollHeight;
    };

    $('#version-toggle').onclick = () => window.location.href = 'index.html';
    $('#toggle-chat').onclick = () => {
      $('#chat-aside').classList.toggle('hidden');
      $('#chat-aside').classList.toggle('block');
    };
    $('#clear-log').onclick = () => $('#log').textContent = 'Ready to publish your elegant site...';

    $('#publish').onclick = async () => {
      try {
        log('✨ Preparing elegant deployment...');
        const dir = puter.randName();
        await puter.fs.mkdir(dir);
        await puter.fs.write(`${dir}/index.html`, $('#editor').value);
        const sub = ($('#sub').value || puter.randName()).toLowerCase();
        log('🎨 Crafting beautiful experience...');
        const site = await puter.hosting.create(sub, dir);
        const url = `https://${site.subdomain}.puter.site`;
        log('🌟 Elegantly published!');
        log(`🔗 ${url}`);
        window.open(url, '_blank');
      } catch (e) {
        log('❌ Publishing failed: ' + (e?.message || 'Unknown error'));
      }
    };

    const chatTA = $('#chat-textarea');
    const appendMsg = (role, txt) => {
      const div = document.createElement('div');
      div.className = role === 'user'
        ? 'bg-gray-100 border border-gray-200 rounded-xl p-4 text-gray-800'
        : 'bg-white border border-gray-200 rounded-xl p-4 text-gray-700';
      
      const label = document.createElement('div');
      label.className = 'text-xs font-medium mb-2 ' + 
        (role === 'user' ? 'text-gray-600' : 'text-gray-500');
      label.textContent = role === 'user' ? 'You' : 'Assistant';
      
      const content = document.createElement('div');
      content.textContent = txt;
      
      div.appendChild(label);
      div.appendChild(content);
      
      const messages = $('#messages');
      if (messages.children.length === 1 && messages.children[0].textContent.includes('How may I assist')) {
        messages.innerHTML = '';
      }
      
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    };

    chatTA.addEventListener('input', () => {
      chatTA.style.height = 'auto';
      chatTA.style.height = Math.min(chatTA.scrollHeight, 120) + 'px';
    });

    async function sendChat() {
      const txt = chatTA.value.trim();
      if (!txt) return;
      appendMsg('user', txt);
      chatTA.value = '';
      chatTA.style.height = 'auto';
      const sendBtn = $('#chat-send');
      sendBtn.disabled = true;
      sendBtn.textContent = '...';
      try {
        const res = await puter.ai.chat(txt);
        const answer = res?.message?.content ?? res?.choices?.[0]?.message?.content ?? res?.text ?? res;
        appendMsg('assistant', answer.toString().trim());
      } catch (e) {
        appendMsg('assistant', 'I apologize, but I encountered an error: ' + (e?.message || 'Unknown error'));
      } finally {
        sendBtn.disabled = false;
        sendBtn.textContent = 'Send';
      }
    }

    $('#chat-send').onclick = sendChat;
    chatTA.addEventListener('keydown', e => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendChat();
      }
    });

    log('✨ Elegant Builder initialized');
  </script>
</body>
</html>